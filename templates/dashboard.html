{% extends "base.html" %}

{% block title %}Dashboard - University Matcher{% endblock %}

{% block hero %}
<section class="hero is-primary">
  <div class="hero-body">
    <div class="container">
      <h1 class="title">
        Welcome, {{ username }}!
      </h1>
      <h2 class="subtitle">
        Your University Matcher Dashboard
      </h2>
    </div>
  </div>
</section>
{% endblock %}

{% block content %}
<div class="container">
  <div class="columns is-desktop">
    <!-- Saved Profiles Section -->
    <div class="column">
      <div class="box">
        <h3 class="title is-4">Your Saved Academic Profiles</h3>
        
        {% if profiles %}
          <div class="profiles-list">
            {% for profile in profiles %}
              <div class="card mb-4">
                <div class="card-content">
                  <p class="title is-5">{{ profile.profile_name }}</p>
                  <div class="content">
                    <p><strong>GPA:</strong> {{ profile.gpa }}</p>
                    <p><strong>SAT Score:</strong> {{ profile.sat_score }}</p>
                    
                    {% if profile.preferred_majors %}
                      <p><strong>Interested Majors:</strong> {{ profile.preferred_majors|join(', ') }}</p>
                    {% endif %}
                    
                    {% if profile.preferred_locations %}
                      <p><strong>Preferred Locations:</strong> {{ profile.preferred_locations|join(', ') }}</p>
                    {% endif %}
                    
                    <p><strong>Budget:</strong> ${{ profile.budget }}</p>
                    <p><strong>Campus Preference:</strong> {{ profile.preferred_environment }}</p>
                    
                    <p class="has-text-grey is-size-7">Created: {{ profile.created_at }}</p>
                  </div>
                </div>
                <footer class="card-footer">
                  <a href="{{ url_for('recommendations', profile_id=profile.id) }}" class="card-footer-item">View Matches</a>
                  <a href="{{ url_for('profile', edit_profile_id=profile.id) }}" class="card-footer-item">Edit</a>
                  <a href="{{ url_for('delete_profile', profile_id=profile.id) }}" 
                     class="card-footer-item has-text-danger"
                     onclick="return confirm('Are you sure you want to delete this profile?')">
                    Delete
                  </a>
                </footer>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="notification is-info is-light">
            <p>You haven't saved any academic profiles yet.</p>
          </div>
          <a href="{{ url_for('profile') }}" class="button is-primary">
            <span class="icon">
              <i class="fas fa-plus"></i>
            </span>
            <span>Create Your First Profile</span>
          </a>
        {% endif %}
      </div>
    </div>
    
    <!-- Saved Recommendations Section -->
    <div class="column">
      <div class="box">
        <h3 class="title is-4">Your Saved University Matches</h3>
        
        {% if recommendations %}
          <div class="recommendations-list">
            {% for rec in recommendations %}
              <div class="card mb-3">
                <div class="card-content">
                  <div class="media">
                    <div class="media-left">
                      <figure class="image is-48x48">
                        <img src="{{ url_for('static', filename='images/university-icon.png') }}" alt="University icon">
                      </figure>
                    </div>
                    <div class="media-content">
                      <p class="title is-5">{{ rec.university_name }}</p>
                      <p class="subtitle is-6">Match Score: <strong>{{ "%.1f"|format(rec.match_score * 100) }}%</strong></p>
                    </div>
                  </div>
                  
                  <div class="content">
                    <p class="is-size-7">Saved from profile: {{ rec.profile_name }}</p>
                    <p class="is-size-7 has-text-grey">Saved on: {{ rec.created_at }}</p>
                  </div>
                </div>
                <footer class="card-footer">
                  <a href="{{ url_for('university_detail', uni_id=rec.university_id) }}" class="card-footer-item">View Details</a>
                  <a href="{{ url_for('delete_saved_recommendation', rec_id=rec.id) }}" 
                     class="card-footer-item has-text-danger"
                     onclick="return confirm('Are you sure you want to remove this university from your saved matches?')">
                    Remove
                  </a>
                </footer>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="notification is-info is-light">
            <p>You haven't saved any university matches yet.</p>
          </div>
          <a href="{{ url_for('profile') }}" class="button is-primary">
            <span class="icon">
              <i class="fas fa-search"></i>
            </span>
            <span>Find University Matches</span>
          </a>
        {% endif %}
      </div>
    </div>
  </div>
  
  <!-- Quick Actions Section -->
  <div class="box mt-5">
    <h3 class="title is-4">Quick Actions</h3>
    <div class="buttons">
      <a href="{{ url_for('profile') }}" class="button is-primary">
        <span class="icon">
          <i class="fas fa-user-graduate"></i>
        </span>
        <span>Create New Profile</span>
      </a>
      <a href="{{ url_for('compare') }}" class="button is-info">
        <span class="icon">
          <i class="fas fa-balance-scale"></i>
        </span>
        <span>Compare Universities</span>
      </a>
      {% if 'admin' in session.get('roles', []) %}
        <a href="{{ url_for('admin_admission_analytics') }}" class="button is-warning">
          <span class="icon">
            <i class="fas fa-chart-bar"></i>
          </span>
          <span>Admission Analytics</span>
        </a>
      {% endif %}
      <a href="{{ url_for('logout') }}" class="button is-light">
        <span class="icon">
          <i class="fas fa-sign-out-alt"></i>
        </span>
        <span>Logout</span>
      </a>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
  .card {
    transition: transform 0.2s, box-shadow 0.2s;
  }
  
  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(10, 10, 10, 0.1);
  }
  
  .profiles-list, .recommendations-list {
    max-height: 600px;
    overflow-y: auto;
    padding-right: 10px;
  }
  
  /* Custom scrollbar for the lists */
  .profiles-list::-webkit-scrollbar, .recommendations-list::-webkit-scrollbar {
    width: 8px;
  }
  
  .profiles-list::-webkit-scrollbar-track, .recommendations-list::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
  }
  
  .profiles-list::-webkit-scrollbar-thumb, .recommendations-list::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
  }
  
  .profiles-list::-webkit-scrollbar-thumb:hover, .recommendations-list::-webkit-scrollbar-thumb:hover {
    background: #555;
  }
</style>
{% endblock %} 